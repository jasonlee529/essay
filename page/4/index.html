<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Java,Linux,Mysql,Devs" />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="Jason Lee Essay">
<meta property="og:url" content="https://blog.xiaokele.site/page/4/index.html">
<meta property="og:site_name" content="Jason Lee Essay">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jason Lee Essay">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.xiaokele.site/page/4/"/>



<meta name="google-site-verification" content="DCecPF2mdIv3j__CgHKZ7KkdHn9F-6f4Grk8xYgVklE" />
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<link rel="alternate" hreflang="zh-Hans" href="https://jasonlee529.github.io" />

<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
{'GTM-P2JZHDB':true});</script>


  <title> Jason Lee Essay </title>
  <!-- Google AdSense start -->
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1336715083812391",
    enable_page_level_ads: true
  });
</script>
<meta name="baidu_union_verify" content="35dd5097cbf7f546e4ec61c6cbd012db">
  <!-- Google AdSense end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-36831740-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?69f02f078fd202b54793c69f3596a63f 69f02f078fd202b54793c69f3596a63f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  
  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>
    <a href="https://github.com/jasonlee529"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jason Lee Essay</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Only dead fish go with the flow!</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>


 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2018/06/05/bower配置私服nexus3-2018-6-5/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/06/05/bower配置私服nexus3-2018-6-5/" itemprop="url">
                  bower配置私服nexus3
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-05T19:30:30+08:00">
                2018-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nexus/" itemprop="url" rel="index">
                    <span itemprop="name">nexus</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/06/05/bower配置私服nexus3-2018-6-5/" class="leancloud_visitors" data-flag-title="bower配置私服nexus3">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>内容来自 <a href="https://help.sonatype.com/repomanager3/bower-repositories#BowerRepositories-BrowsingBowerRepositoriesandSearchingPackages" target="_blank" rel="noopener">https://help.sonatype.com/repomanager3/bower-repositories#BowerRepositories-BrowsingBowerRepositoriesandSearchingPackages</a><br>nexus3.0版本不仅提供了maven的私服，还可以托管docker、npm、bower甚至是python的仓库，为搭建统一的私服平台提供了便利。</p>
</blockquote>
<h1 id="Bower-仓库"><a href="#Bower-仓库" class="headerlink" title="Bower 仓库"></a>Bower 仓库</h1><h5 id="1-简介"><a href="#1-简介" class="headerlink" title="* 1.简介"></a>* <a href="#1">1.简介</a></h5><h5 id="2-代理仓库"><a href="#2-代理仓库" class="headerlink" title="* 2.代理仓库"></a>* <a href="#2">2.代理仓库</a></h5><h5 id="3-本地私服仓库"><a href="#3-本地私服仓库" class="headerlink" title="* 3.本地私服仓库"></a>* <a href="#3">3.本地私服仓库</a></h5><h5 id="4-公开仓库组"><a href="#4-公开仓库组" class="headerlink" title="* 4.公开仓库组"></a>* <a href="#4">4.公开仓库组</a></h5><h5 id="5-安装bower"><a href="#5-安装bower" class="headerlink" title="* 5.安装bower"></a>* <a href="#5">5.安装bower</a></h5><h5 id="6-配置私服下载"><a href="#6-配置私服下载" class="headerlink" title="* 6.配置私服下载"></a>* <a href="#6">6.配置私服下载</a></h5><h5 id="7-浏览和检索依赖"><a href="#7-浏览和检索依赖" class="headerlink" title="* 7.浏览和检索依赖"></a>* <a href="#7">7.浏览和检索依赖</a></h5><h5 id="8-上传bower包"><a href="#8-上传bower包" class="headerlink" title="* 8.上传bower包"></a>* <a href="#8">8.上传bower包</a></h5><p></p><h2 id="1">简介</h2><br> Bower是一个前端包管理工具。<p></p>
<p>NexusOSS是一个强大的Maven仓库管理器，它极大地简化了自己内部仓库的维护和外部仓库的访问。利用Nexus你可以只在一个地方就能够完全控制访问和部署在你所维护仓库中的每个Artifact。Nexus是一套“开箱即用”的系统不需要数据库，它使用文件系统加Lucene来组织数据。3.0版本之后加入了npm、bower、docker还有.net的仓库管理。</p>
<p></p><h2 id="2">代理仓库</h2><br>NexusOss可以对bower的外部仓库进行代理，比如代理官方库：<a href="https://registry.bower.io" target="_blank" rel="noopener">https://registry.bower.io</a> 。在官方库速度较慢的情况下非常好用。<p></p>
<p>创建bower代理库的步骤：</p>
<ul>
<li>选择创建repository,类型为bower(proxy)</li>
<li>定义仓库名称：bower-proxy</li>
<li>定义代理的仓库地址，例如官方仓库： <a href="https://registry.bower.io" target="_blank" rel="noopener">https://registry.bower.io</a></li>
<li>选择合适的存储</li>
</ul>
<p></p><h2 id="3">本地私服仓库</h2><br>NexusOss支持创建本地私服用于管理bower包。私服仓库扮演了一个权威角色，定义包的URL和名称的关系。<p></p>
<p>创建本地私服仓库的操作步骤:</p>
<ul>
<li>选择创建repository,类型为bower(hosted)</li>
<li>定义名称：bower-hosted</li>
<li>选择合适的存储</li>
</ul>
<p></p><h2 id="4">公开仓库组</h2><br>推荐使用仓库组暴露Bower仓库地址。仓库组既可以暴露多个代理仓库和多个本地私服仓库，当代理仓库或者私服变动的时候不会影响到使用者。<p></p>
<p>创建步骤如下:</p>
<ul>
<li>选择创建repository,类型为bower(group)</li>
<li>定义名称：bower-all</li>
<li>选择合适的存储</li>
<li>添加bower-proxy和bower-hosted仓库到组中<br><h2 id="5">安装bower</h2><br>通过npm安装：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install -g bower </span><br><span class="line"><span class="meta">$</span> bower -v</span><br><span class="line">1.7.7</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>使用Bower私服需要添加一个解析自定义URL的组件来完成解析NexusOss的工作。可以通过下面两种方式引入：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g bower-nexus3-resolver</span><br></pre></td></tr></table></figure></p>
<p>或者引入到package.json中<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"devDependencies" : &#123;</span><br><span class="line">   "bower-nexus3-resolver" : "*"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p></p><h2 id="6">配置私服下载</h2><br>一旦配置了Bower私服，就需要配置.bowerrc文件来实现到私服的URL解析。一般需要配置.bowerrc文件，可以配置全局的.bowerrc，位于$HOME目录下，也可以配置在项目内部的.bowerrc文件中。<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"registry"</span> : &#123;</span><br><span class="line">    <span class="attr">"search"</span> : [ <span class="string">"http://localhost:8081/repository/bower-all"</span> ]</span><br><span class="line">   &#125;,</span><br><span class="line"> <span class="attr">"resolvers"</span> : [ <span class="string">"bower-nexus3-resolver"</span> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p>测试下效果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> bower install jquery</span><br><span class="line">bower jquery#*</span><br><span class="line">  not-cached nexus+http://localhost:8081/repository/bower-all/jquery#*</span><br><span class="line">bower jquery#*</span><br><span class="line">  resolve nexus+http://localhost:8081/repository/bower-all/jquery#*</span><br><span class="line">bower jquery#*</span><br><span class="line">  resolved nexus+http://localhost:8081/repository/bower-all/jquery#2.2.0</span><br><span class="line">bower jquery#^2.2.0  install jquery#2.2.0</span><br><span class="line"></span><br><span class="line"><span class="meta">jquery#</span>2.2.0 bower_components/jquery</span><br></pre></td></tr></table></figure>
<p></p><h2 id="7">浏览和检索依赖</h2><br>NexusOSS提供了网页检索和浏览包，当然也可以通过Bower的命令行参数来检索。<p></p>
<p></p><h2 id="8">上传bower包</h2><br>发布Bower包，需要配置.bowerrc文件，制定register的位置；需要指定包的git路径。<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"registry"</span> : &#123;</span><br><span class="line">        <span class="attr">"search"</span> : [</span><br><span class="line">            <span class="string">"http://192.168.1.62:8081/nexus/repository/bower-all"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">"register"</span> : <span class="string">"http://admin:admin123@192.168.1.62:8081/nexus/repository/bower-hosted"</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">"resolvers"</span> : [ <span class="string">"bower-nexus3-resolver"</span> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p>执行上传操作:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bower register example-package git://gitserver/project.git</span><br></pre></td></tr></table></figure></p>
<p>测试安装:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bower install example-package</span><br></pre></td></tr></table></figure></p>
<p>##　小结：<br>上次部分注意的是register的URL必须把授权参数填入，因为NexusOss侧需要权限验证，不写会一直报401的错误。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2018/06/01/k8s踩坑记第1篇-rc无法创建-2018-6-1/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/06/01/k8s踩坑记第1篇-rc无法创建-2018-6-1/" itemprop="url">
                  k8s踩坑记第1篇--rc无法创建
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-01T17:12:09+08:00">
                2018-06-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/k8s/" itemprop="url" rel="index">
                    <span itemprop="name">k8s</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/06/01/k8s踩坑记第1篇-rc无法创建-2018-6-1/" class="leancloud_visitors" data-flag-title="k8s踩坑记第1篇--rc无法创建">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>六一快乐!!!</p>
</blockquote>
<p>什么是k8s，我不想解释，百度资料有很多，本系列只踩坑，不科普。</p>
<h1 id="问题描述："><a href="#问题描述：" class="headerlink" title="问题描述："></a>问题描述：</h1><blockquote>
<p>做Hello　World的例子，结果get pods一直显示没有资源？</p>
</blockquote>
<p>应用配置代码：<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">apiVersion</span> <span class="string">:</span> <span class="string">v1</span></span><br><span class="line"><span class="string">kind</span> <span class="string">:</span> <span class="string">ReplicationController</span></span><br><span class="line"><span class="string">metadata</span> <span class="string">:</span> </span><br><span class="line">    <span class="string">name</span> <span class="string">:</span> <span class="string">mysql</span></span><br><span class="line"><span class="string">spec</span> <span class="string">:</span> </span><br><span class="line">  <span class="string">replicas</span> <span class="string">:</span> <span class="number">2</span></span><br><span class="line">  <span class="string">selector</span> <span class="string">:</span> </span><br><span class="line">    <span class="string">app</span> <span class="string">:</span> <span class="string">mysql</span></span><br><span class="line">  <span class="string">template</span> <span class="string">:</span> </span><br><span class="line">    <span class="string">metadata</span> <span class="string">:</span> </span><br><span class="line">      <span class="string">labels</span> <span class="string">:</span> </span><br><span class="line">        <span class="string">app</span> <span class="string">:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="string">spec</span> <span class="string">:</span> </span><br><span class="line">      <span class="string">containers</span> <span class="string">:</span> </span><br><span class="line"><span class="bullet">      -</span> <span class="string">name</span> <span class="string">:</span> <span class="string">mysql</span></span><br><span class="line">        <span class="string">image</span> <span class="string">:</span> <span class="string">mysql</span></span><br><span class="line">        <span class="string">ports</span> <span class="string">:</span> </span><br><span class="line"><span class="bullet">        -</span> <span class="string">containerPort</span> <span class="string">:</span> <span class="number">3306</span></span><br><span class="line">        <span class="string">env</span> <span class="string">:</span> </span><br><span class="line"><span class="bullet">        -</span> <span class="string">name</span> <span class="string">:</span> <span class="string">MYSQL_ROOT_PASSWORD</span></span><br><span class="line">          <span class="string">value</span> <span class="string">:</span> <span class="string">"123456"</span></span><br></pre></td></tr></table></figure></p>
<p>创建rc<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> kubectl create -f mysql-rc.yaml </span></span><br><span class="line">replicationcontroller "mysql" created</span><br><span class="line"><span class="meta">#</span><span class="bash"> kubectl get rc</span></span><br><span class="line">NAME      DESIRED   CURRENT   READY     AGE</span><br><span class="line">mysql     2         0         0         11s</span><br><span class="line">myweb     2         0         0         5s</span><br><span class="line"><span class="meta">#</span><span class="bash"> kubectl get pods</span></span><br><span class="line">No resources found.</span><br><span class="line"><span class="meta">#</span><span class="bash"> docker images</span></span><br><span class="line">REPOSITORY                                            TAG                 IMAGE ID            CREATED             SIZE</span><br></pre></td></tr></table></figure></p>
<h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><p>创建了rc之后,虽然命令行提示成功了，但是pods一直没有创建，也检查了docker，mysql的镜像没有拉取。又仔细看了一边rc的结果，current和ready列的值是0，应该先解决current为０的问题。</p>
<h1 id="google解决方案"><a href="#google解决方案" class="headerlink" title="google解决方案"></a>google解决方案</h1><ol>
<li>executed command :<blockquote>
<p>openssl genrsa -out /tmp/serviceaccount.ket 2048</p>
</blockquote>
</li>
<li>modified the /etc/kubernetes/apiserver file to add following :<blockquote>
<p>KUBE_API_ARGS=”–service_account_key_file=/tmp/serviceaccount.key”</p>
</blockquote>
</li>
<li>modified the /etc/kubernetes/controller-manager and add following:　<blockquote>
<p>KUBE_CONTROLLER_MANAGER_ARGS=”–service_account_private_key_file=/tmp/serviceaccount.key”</p>
</blockquote>
</li>
<li>restarted the kube-apiserver and kube-controller-manager services to restart the services<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service kube-apiserver restart</span><br><span class="line">service kube-controller-manager restart</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>参考：<br><a href="https://blog.csdn.net/jinzhencs/article/details/51435020" target="_blank" rel="noopener">https://blog.csdn.net/jinzhencs/article/details/51435020</a><br><a href="https://github.com/kubernetes/kubernetes/issues/11355#issuecomment-127378691" target="_blank" rel="noopener">https://github.com/kubernetes/kubernetes/issues/11355#issuecomment-127378691</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2018/05/25/springmvc自定义的错误处理器-2018-5-25/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/05/25/springmvc自定义的错误处理器-2018-5-25/" itemprop="url">
                  springmvc自定义的错误处理器
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-25T16:22:49+08:00">
                2018-05-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/springmvc/" itemprop="url" rel="index">
                    <span itemprop="name">springmvc</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/05/25/springmvc自定义的错误处理器-2018-5-25/" class="leancloud_visitors" data-flag-title="springmvc自定义的错误处理器">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2018/05/23/git中闹不明白的autocrlf-2018-5-23/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/05/23/git中闹不明白的autocrlf-2018-5-23/" itemprop="url">
                  git中闹不明白的autocrlf
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T15:10:52+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/git/" itemprop="url" rel="index">
                    <span itemprop="name">git</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/05/23/git中闹不明白的autocrlf-2018-5-23/" class="leancloud_visitors" data-flag-title="git中闹不明白的autocrlf">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>git管理代码仓库的时候，会经常遇到这样的情况：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">warning: CRLF will be replaced by LF in Test.java.</span><br><span class="line">The file will have its original line endings in your working directory.</span><br></pre></td></tr></table></figure></p>
<p>遇到上面的警告， 基本上都是将 autocrlf 设置为 false　解决，或者手动改变文件的CRLF属性。（IDEA具备这个功能，其他编辑器不知道）</p>
<h2 id="什么是CRLF"><a href="#什么是CRLF" class="headerlink" title="什么是CRLF?"></a>什么是CRLF?</h2><p>CRLF是Carriage-Return Line-Feed的缩写，意思是回车换行，就是回车(CR, ASCII 13, \r) 换行(LF, ASCII 10, \n)。</p>
<h2 id="有什么不同？"><a href="#有什么不同？" class="headerlink" title="有什么不同？"></a>有什么不同？</h2><ul>
<li>CRLF-&gt;Windows-style</li>
<li>LF-&gt;Unix Style</li>
<li>CR-&gt;Mac Style</li>
</ul>
<p>CRLF表示句尾使用回车换行两个字符(即我们常在Windows编程时使用”\r\n”换行)<br>LF表示表示句尾，只使用换行.<br>CR表示只使用回车.</p>
<h2 id="git的三种模式"><a href="#git的三种模式" class="headerlink" title="git的三种模式"></a>git的三种模式</h2><p>core.autocrlf有三种模式，分别对应三种转换情况。x代码换行符号，第一个是pull的转换情况，第二个是commit的时候情况。<br>1) true:             x -&gt; LF -&gt; CRLF<br>2) input:            x -&gt; LF -&gt; LF<br>3) false:            x -&gt; x -&gt; x</p>
<h3 id="换行符-LF-autocrlf-true"><a href="#换行符-LF-autocrlf-true" class="headerlink" title="换行符=LF,autocrlf=true"></a>换行符=LF,autocrlf=true</h3><p>如果你的源文件中是换行符是LF，而autocrlf=true, 此时git add就会遇到 fatal: LF would be replaced by CRLF 的错误。有两个解决办法：</p>
<ol>
<li>将源文件中的LF转为CRLF即可【推荐】</li>
<li>将autocrlf 设置为 false</li>
</ol>
<h3 id="换行符-CRLF-autocrlf-input"><a href="#换行符-CRLF-autocrlf-input" class="headerlink" title="换行符=CRLF,autocrlf=input"></a>换行符=CRLF,autocrlf=input</h3><p>如果你的源文件中是换行符是CRLF，而autocrlf=input,  此时git add也会遇到 fatal: CRLF would be replaced by LF 的错误。有两个解决办法：</p>
<ol>
<li>将你源文件中的CRLF转为LF【推荐】</li>
<li>将autocrlf 设置为true 或者 false</li>
</ol>
<h2 id="我的建议：在Unix-Linux上设置-autocrlf-input-在Windows上设置autocrlf-true（默认值）。"><a href="#我的建议：在Unix-Linux上设置-autocrlf-input-在Windows上设置autocrlf-true（默认值）。" class="headerlink" title="我的建议：在Unix/Linux上设置 autocrlf = input, 在Windows上设置autocrlf = true（默认值）。"></a>我的建议：在Unix/Linux上设置 autocrlf = input, 在Windows上设置autocrlf = true（默认值）。</h2><p>这样的话，<br>Windows：（true）<br>提交时，将CRLF 转成 LF再提交；<br>切出时，自动将LF 转为 CRLF;</p>
<p>Unix/Linux: (input)<br>提交时,   将CRLF 转成 LF再提交；<br>切出时，保持LF即可</p>
<h2 id="这样即可保证仓库中永远都是LF-而且在Windows工作空间都是CRLF-Unix-Linux工作空间都是LF"><a href="#这样即可保证仓库中永远都是LF-而且在Windows工作空间都是CRLF-Unix-Linux工作空间都是LF" class="headerlink" title="这样即可保证仓库中永远都是LF. 而且在Windows工作空间都是CRLF, Unix/Linux工作空间都是LF."></a>这样即可保证仓库中永远都是LF. 而且在Windows工作空间都是CRLF, Unix/Linux工作空间都是LF.</h2><p>core.autocrlf<br>假如你正在Windows上写程序，又或者你正在和其他人合作，他们在Windows上编程，而你却在其他系统上，在这些情况下，你可能会遇到行尾结束符问题。这是因为Windows使用回车和换行两个字符来结束一行，而Mac和Linux只使用换行一个字符。虽然这是小问题，但它会极大地扰乱跨平台协作。</p>
<p>Git可以在你提交时自动地把行结束符CRLF转换成LF，而在签出代码时把LF转换成CRLF。用core.autocrlf来打开此项功能，如果是在Windows系统上，把它设置成true，这样当签出代码时，LF会被转换成CRLF：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> git config --global core.autocrlf true</span><br></pre></td></tr></table></figure>
<p>Linux或Mac系统使用LF作为行结束符，因此你不想 Git 在签出文件时进行自动的转换；当一个以CRLF为行结束符的文件不小心被引入时你肯定想进行修正，把core.autocrlf设置成input来告诉 Git 在提交时把CRLF转换成LF，签出时不转换：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> git config --global core.autocrlf input</span><br></pre></td></tr></table></figure>
<p>这样会在Windows系统上的签出文件中保留CRLF，会在Mac和Linux系统上，包括仓库中保留LF。<br>如果你是Windows程序员，且正在开发仅运行在Windows上的项目，可以设置false取消此功能，把回车符记录在库中：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> git config --global core.autocrlf false</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2018/05/10/maven-配置私服提交权限-2018-5-10/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/05/10/maven-配置私服提交权限-2018-5-10/" itemprop="url">
                  maven-配置私服提交权限
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-10T13:49:58+08:00">
                2018-05-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/maven/" itemprop="url" rel="index">
                    <span itemprop="name">maven</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/maven/nexus/" itemprop="url" rel="index">
                    <span itemprop="name">nexus</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/05/10/maven-配置私服提交权限-2018-5-10/" class="leancloud_visitors" data-flag-title="maven-配置私服提交权限">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>自定义的jar包提交到nexus的私服中，直接通过maven命令提交。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean source:jar deploy -X -DskipTests=true</span><br></pre></td></tr></table></figure></p>
<p>参数解释：</p>
<ul>
<li>clean 清空上次编译结果</li>
<li>deploy 发布到情况</li>
<li>source:jar 同步发布源码</li>
<li>-X debug级别日志输出</li>
<li>-DskipTests=true 跳过单元测试</li>
</ul>
<p>执行的过程中出现一个错误：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ERROR] Failed to execute goal org.apache.maven.plugins:maven-deploy-plugin:2.7:deploy (default-deploy) on project io: Failed to deploy artifacts: Could not transfer artifact cn.infisa:io:jar:1.0.2-RELEASE from/to releases (http://192.168.1.62:8081/nexus/content/repositories/releases/): Failed to transfer file: http://192.168.1.62:8081/nexus/content/repositories/releases/cn/infisa/io/1.0.2-RELEASE/io-1.0.2-RELEASE.jar. Return code is: 401, ReasonPhrase: Unauthorized. -&gt; [Help 1]</span><br></pre></td></tr></table></figure></p>
<p>原因：　本地用户提交releases或者snapshots里面，需要配置对应的权限，而且需要在settings.xml中配置。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">username</span>&gt;</span>username<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">password</span>&gt;</span>password<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>再次提交，成功通过。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2018/05/08/Java如何调用shell脚本的-2018-5-8/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/05/08/Java如何调用shell脚本的-2018-5-8/" itemprop="url">
                  Java如何调用shell脚本的
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-08T11:59:42+08:00">
                2018-05-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/05/08/Java如何调用shell脚本的-2018-5-8/" class="leancloud_visitors" data-flag-title="Java如何调用shell脚本的">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>有些时候会碰到这样的场景：java的功能里面要嵌入一个功能点，这个功能是通过是shell脚本实现的。这种时候就需要Java对脚本调用的支持了。</p>
<h2 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h2><p>Ubuntu16.04 i3-6100,12GB</p>
<h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><p>来看一个基本的例子<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    Process exec = Runtime.getRuntime().exec(<span class="keyword">new</span> String[] &#123; <span class="string">"uname"</span> ,<span class="string">"-a"</span>&#125;);</span><br><span class="line">    exec.waitFor();</span><br><span class="line">    BufferedReader reader =</span><br><span class="line">            <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(exec.getInputStream()));</span><br><span class="line">    System.out.println(reader.readLine());</span><br><span class="line"></span><br><span class="line">Linux jason-Inspiron-3650 4.4.0-121-generic #145-Ubuntu SMP Fri Apr 13 13:47:23 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span><br></pre></td></tr></table></figure></p>
<h2 id="解读Process"><a href="#解读Process" class="headerlink" title="解读Process"></a>解读Process</h2><p>java.lang.Process类提供了获取输入、输出、等待执行和销毁进程的方法。<br>Process类可通过ProcessBuilder.start() 和 Runtime.exec 创建实例，从Java1.5开始，ProcessBuilder.start()是更推荐的做法，但网上的教程更多推荐用Runtime.exec()方法。</p>
<table>
<thead>
<tr>
<th>Modifier and Type</th>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>abstract void</td>
<td>destroy ()</td>
<td>Kills the subprocess.</td>
</tr>
<tr>
<td>abstract int</td>
<td>exitValue ()</td>
<td>Returns the exit value for the subprocess.</td>
</tr>
<tr>
<td>abstract  InputStream</td>
<td>getErrorStream ()</td>
<td>Returns the input stream connected to the error output of the subprocess.</td>
</tr>
<tr>
<td>abstract  InputStream</td>
<td>getInputStream ()</td>
<td>Returns the input stream connected to the normal output of the subprocess.</td>
</tr>
<tr>
<td>abstract  OutputStream</td>
<td>getOutputStream ()</td>
<td>Returns the output stream connected to the normal input of the subprocess.</td>
</tr>
<tr>
<td>abstract int</td>
<td>waitFor ()</td>
<td>Causes the current thread to wait, if necessary, until the process represented by this Process object has terminated.</td>
</tr>
</tbody>
</table>
<p>继承体系上面，Process的实现类是JDK内置的，linux版本的jdk中只带有一个实现类UnixProcess。</p>
<h2 id="与脚本交互"><a href="#与脚本交互" class="headerlink" title="与脚本交互"></a>与脚本交互</h2><p>Process不但可以执行进程，还可以获取进程的返回结果。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">executeCommand</span><span class="params">(String command)</span> </span>&#123;</span><br><span class="line">        StringBuffer output = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        Process p;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            p = Runtime.getRuntime().exec(command);</span><br><span class="line">            <span class="keyword">int</span> exitCode = p.waitFor();</span><br><span class="line">            System.out.println(exitCode);</span><br><span class="line">            BufferedReader reader =</span><br><span class="line">                    <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(p.getInputStream()));</span><br><span class="line">            String line = <span class="string">""</span>;</span><br><span class="line">            <span class="keyword">while</span> ((line = reader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                output.append(line + <span class="string">"\n"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(output.toString());</span><br><span class="line">        <span class="keyword">return</span> output.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">PING www.a.shifen.com (<span class="number">111.13</span>.100.91) <span class="number">56</span>(<span class="number">84</span>) bytes of data.</span><br><span class="line"><span class="number">64</span> <span class="function">bytes from <span class="title">localhost</span> <span class="params">(<span class="number">111.13</span><span class="number">.100</span><span class="number">.91</span>)</span>: icmp_seq</span>=<span class="number">1</span> ttl=<span class="number">52</span> time=<span class="number">7.66</span> ms</span><br><span class="line"><span class="number">64</span> <span class="function">bytes from <span class="title">localhost</span> <span class="params">(<span class="number">111.13</span><span class="number">.100</span><span class="number">.91</span>)</span>: icmp_seq</span>=<span class="number">2</span> ttl=<span class="number">52</span> time=<span class="number">7.90</span> ms</span><br><span class="line"><span class="number">64</span> <span class="function">bytes from <span class="title">localhost</span> <span class="params">(<span class="number">111.13</span><span class="number">.100</span><span class="number">.91</span>)</span>: icmp_seq</span>=<span class="number">3</span> ttl=<span class="number">52</span> time=<span class="number">14.0</span> ms</span><br><span class="line"></span><br><span class="line">--- www.a.shifen.com ping statistics ---</span><br><span class="line"><span class="number">3</span> packets transmitted, <span class="number">3</span> received, <span class="number">0</span>% packet loss, time <span class="number">2003</span>ms</span><br><span class="line">rtt min/avg/max/mdev = <span class="number">7.668</span>/<span class="number">9.861</span>/<span class="number">14.013</span>/<span class="number">2.937</span> ms</span><br></pre></td></tr></table></figure></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Java 执行脚本的方式其实类似用直接在bash里面执行脚本，区别在于环境有些变动，执行的效果和bash基本一致。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2018/05/07/Spring-boot项目整合监控actuator-2018-5-7/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/05/07/Spring-boot项目整合监控actuator-2018-5-7/" itemprop="url">
                  Spring-boot项目整合监控actuator
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-07T11:53:18+08:00">
                2018-05-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/spring-boot/" itemprop="url" rel="index">
                    <span itemprop="name">spring-boot</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/05/07/Spring-boot项目整合监控actuator-2018-5-7/" class="leancloud_visitors" data-flag-title="Spring-boot项目整合监控actuator">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Spring-boot包含众多的starter，每一个starter都包含了一个方面的最佳实践，比如spring-boot-starter-web包含了构建web应用的依赖框架，spring-boot-starter-logging包含了日志输出所需框架的合集。而本文的主角spring-boot-starter-actuator包含了metrics的相关工具集。</p>
<h2 id="什么是actuator"><a href="#什么是actuator" class="headerlink" title="什么是actuator?"></a>什么是actuator?</h2><blockquote>
<p>Spring Boot Actuator includes a number of additional features to help you monitor and manage your application when it’s pushed to production. You can choose to manage and monitor your application using HTTP or JMX endpoints. Auditing, health and metrics gathering can be automatically applied to your application. The user guide covers the features in more detail.<br>Spring Boot Actuator包含了一些额外的特性用于生产环境中监控和管理spring　boot应用。actuator可以通过<strong>HTTP</strong>或者<strong>JMX</strong>对应用进行管控。可以自动收集审计、健康和度量信息。用户手册包含了更多的细节。</p>
</blockquote>
<p>土话就是，线上应用都需要管控工具，省得大家再去造一个轮子了，spring-boot造好了一个，开箱即用，都到碗里来吧。</p>
<h2 id="actuator的dependency分析"><a href="#actuator的dependency分析" class="headerlink" title="actuator的dependency分析"></a>actuator的dependency分析</h2><p>以1.5.4.RELEASE版本为例<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> mvn dependency:tree</span><br><span class="line">[INFO] \- org.springframework.boot:spring-boot-starter-actuator:jar:1.5.4.RELEASE:compile</span><br><span class="line">[INFO]    +- org.springframework.boot:spring-boot-starter:jar:1.5.4.RELEASE:compile</span><br><span class="line">[INFO]    |  +- org.springframework.boot:spring-boot:jar:1.5.4.RELEASE:compile</span><br><span class="line">[INFO]    |  +- org.springframework.boot:spring-boot-autoconfigure:jar:1.5.4.RELEASE:compile</span><br><span class="line">[INFO]    |  +- org.springframework.boot:spring-boot-starter-logging:jar:1.5.4.RELEASE:compile</span><br><span class="line">[INFO]    |  |  +- ch.qos.logback:logback-classic:jar:1.1.11:compile</span><br><span class="line">[INFO]    |  |  |  +- ch.qos.logback:logback-core:jar:1.1.11:compile</span><br><span class="line">[INFO]    |  |  |  \- org.slf4j:slf4j-api:jar:1.7.22:compile</span><br><span class="line">[INFO]    |  |  +- org.slf4j:jcl-over-slf4j:jar:1.7.25:compile</span><br><span class="line">[INFO]    |  |  +- org.slf4j:jul-to-slf4j:jar:1.7.25:compile</span><br><span class="line">[INFO]    |  |  \- org.slf4j:log4j-over-slf4j:jar:1.7.25:compile</span><br><span class="line">[INFO]    |  +- org.springframework:spring-core:jar:4.3.9.RELEASE:compile</span><br><span class="line">[INFO]    |  \- org.yaml:snakeyaml:jar:1.17:runtime</span><br><span class="line">[INFO]    \- org.springframework.boot:spring-boot-actuator:jar:1.5.4.RELEASE:compile</span><br><span class="line">[INFO]       +- com.fasterxml.jackson.core:jackson-databind:jar:2.8.8:compile</span><br><span class="line">[INFO]       |  +- com.fasterxml.jackson.core:jackson-annotations:jar:2.8.0:compile</span><br><span class="line">[INFO]       |  \- com.fasterxml.jackson.core:jackson-core:jar:2.8.8:compile</span><br><span class="line">[INFO]       \- org.springframework:spring-context:jar:4.3.9.RELEASE:compile</span><br><span class="line">[INFO]          +- org.springframework:spring-aop:jar:4.3.9.RELEASE:compile</span><br><span class="line">[INFO]          +- org.springframework:spring-beans:jar:4.3.9.RELEASE:compile</span><br><span class="line">[INFO]          \- org.springframework:spring-expression:jar:4.3.9.RELEASE:compile</span><br></pre></td></tr></table></figure></p>
<p>核心依赖项目主要是spring-boot的相关基础组件和日志组件。</p>
<ul>
<li>sfl4j和logback相关的都是日志类的组件。</li>
<li>jackson相关是json处理组件。</li>
<li>spring-context和beans,core,aop,expression这些是任何spring项目几乎都需要的组件</li>
<li>spring-boot还有spring-boot-autoconfig以及yaml是spring－boot的基础组建，提供默认配置和yml配置的解析支持。</li>
<li>spring-boot-actuator提供了监控的特性</li>
</ul>
<h2 id="开箱即用"><a href="#开箱即用" class="headerlink" title="开箱即用"></a>开箱即用</h2><p>在pom.xml中添加：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>然后直接启动就可以了，启动后可以查看最简单的http接口<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> curl localhost:8080/health</span><br><span class="line">&#123;</span><br><span class="line">status: "UP",</span><br><span class="line">diskSpace: &#123;</span><br><span class="line">status: "UP",</span><br><span class="line">total: 196726059008,</span><br><span class="line">free: 163859410944,</span><br><span class="line">threshold: 10485760,</span><br><span class="line">&#125;,</span><br><span class="line">db: &#123;</span><br><span class="line">status: "UP",</span><br><span class="line">database: "MySQL",</span><br><span class="line">hello: 1,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2018/04/26/当git遇上中文乱码-2018-4-26/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/04/26/当git遇上中文乱码-2018-4-26/" itemprop="url">
                  当git遇上中文乱码
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-26T16:07:11+08:00">
                2018-04-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/git/" itemprop="url" rel="index">
                    <span itemprop="name">git</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/04/26/当git遇上中文乱码-2018-4-26/" class="leancloud_visitors" data-flag-title="当git遇上中文乱码">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>git有个比较奇怪的问题，当目录或者文件名中出现了中文的时候，在执行git status 的时候，会返回一串unicode码，这段unicode码就读不懂了，必须解决。</p>
<h2 id="git-status显示unicode-乱码"><a href="#git-status显示unicode-乱码" class="headerlink" title="git status显示unicode/乱码"></a>git status显示unicode/乱码</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">untracked file :</span><br><span class="line">    "\346\265\213\350\257\225/"</span><br></pre></td></tr></table></figure>
<h3 id="解决方法："><a href="#解决方法：" class="headerlink" title="解决方法："></a>解决方法：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git config --global core.quotepath <span class="literal">false</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">untracked file :</span><br><span class="line">    测试/文件.md</span><br></pre></td></tr></table></figure>
<h3 id="解惑："><a href="#解惑：" class="headerlink" title="解惑："></a>解惑：</h3><p>core.quotepath的作用是控制路径是否编码显示的选项。当路径中的字符大于0x80的时候，如果设置为true，转义显示；设置为false，不转义。</p>
<h2 id="git-commit-log-中乱码"><a href="#git-commit-log-中乱码" class="headerlink" title="git commit log 中乱码"></a>git commit log 中乱码</h2><p>windows平台上面的问题比linux上面要更多。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git config --global gui.encoding utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config --global i18n.commitEncoding utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config --global gui.logOutputEncoding utf-8</span></span><br></pre></td></tr></table></figure></p>
<p>以上基本可全部解决。</p>
<h2 id="windows平台显示乱码"><a href="#windows平台显示乱码" class="headerlink" title="windows平台显示乱码"></a>windows平台显示乱码</h2><p>右键gitbash 选中“Options(选项)”-“text”.设置下面的locale为 zh_CN，Character Set 为UTF-8。<br>强烈推荐全部选用UTF-8,少用GBK。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2018/04/24/docker还能不能愉快的pull了？-2018-4-24/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/04/24/docker还能不能愉快的pull了？-2018-4-24/" itemprop="url">
                  docker还能不能愉快的pull了？
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-24T17:58:00+08:00">
                2018-04-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/04/24/docker还能不能愉快的pull了？-2018-4-24/" class="leancloud_visitors" data-flag-title="docker还能不能愉快的pull了？">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近貌似docker的镜像又被墙了，官方镜像本来就慢的要杀人，第三方的elk镜像不知道怎么也挂了，pull的时候一直报超时？</p>
<p>docker还有一个叫做http_proxy的东西，可通过代理获取镜像？<br>但是，有多台机器都要用到镜像？都陪代理吗？不行，心疼代理钱。那只能再搞一个私有的docker registry。</p>
<p>看看，我原本只是要一个镜像，结果平白添加了两件事？</p>
<h2 id="还原问题"><a href="#还原问题" class="headerlink" title="还原问题"></a>还原问题</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> docker pull docker.elastic.co/elasticsearch/elasticsearch:6.2.4</span><br></pre></td></tr></table></figure>
<h2 id="添加代理"><a href="#添加代理" class="headerlink" title="添加代理"></a>添加代理</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> export ALL_PROXY=socks5://localhost:port </span><br><span class="line"><span class="meta">$</span> docker pull image</span><br></pre></td></tr></table></figure>
<h2 id="添加registry"><a href="#添加registry" class="headerlink" title="添加registry"></a>添加registry</h2><p>registry有很多种，内网版本，阿里云、DaoCloud等任意一家云厂商的registry。</p>
<p>如果公司的局域网，一定要搭建一个私服registry，速度提升的速度不要太明显了。推荐一下Nexus3,可以作为Maven、npm和docker三方私服。</p>
<p>如果在家办公，就一个电脑需要pull，那直接用云厂商的服务更好。</p>
<p>以阿里云为例：<br>在阿里云的产品目录中找到“容器镜像服务-镜像中心-镜像加速器”这个功能，如果第一次打开可能会提示开通。<br>里面有具体的安装方式。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'</span><br><span class="line">&#123;</span><br><span class="line">  "registry-mirrors": ["https://id.mirror.aliyuncs.com"]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2018/04/18/spring-boot-项目添加logback-2018-4-18/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/04/18/spring-boot-项目添加logback-2018-4-18/" itemprop="url">
                  spring-boot 项目添加logback
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-18T15:01:49+08:00">
                2018-04-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index">
                    <span itemprop="name">spring</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/spring-boot/" itemprop="url" rel="index">
                    <span itemprop="name">spring-boot</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/04/18/spring-boot-项目添加logback-2018-4-18/" class="leancloud_visitors" data-flag-title="spring-boot 项目添加logback">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>使用spring-boot项目中添加日志输出，java的日志输出一共有两个大的方案log4j/log4j2 ，logback。log4j2算是对log4j的一个升级版本。<br>常规做法是引入slf4j作为日志入口，log4j或者logback选择一个做实现。spring的项目里面，只有spring-boot-starter-web用的是log4j，其他的用过的starter全部都是logback。</p>
<h2 id="依赖-dependency-spring-boot-starter-logging"><a href="#依赖-dependency-spring-boot-starter-logging" class="headerlink" title="依赖 dependency-spring-boot-starter-logging"></a>依赖 dependency-spring-boot-starter-logging</h2><p>spring-boot-starter-logging还有两个很容易混淆的变种的starter<br><strong>spring-boot-starter-log4j</strong> 和 <strong>spring-boot-starter-log4j2</strong></p>
<p>前者在版本更新到了1.3之后就停止了，后者持续更新，需要注意下。</p>
<h2 id="dependencies"><a href="#dependencies" class="headerlink" title="dependencies"></a>dependencies</h2><p>spring-boot-starter-logging 依赖有</p>
<table>
<thead>
<tr>
<th>groupId</th>
<th>artifactId</th>
<th>version</th>
</tr>
</thead>
<tbody>
<tr>
<td>ch.qos.logback</td>
<td>logback-classic</td>
<td>1.2.3</td>
</tr>
<tr>
<td>org.apache.logging.log4j</td>
<td>log4j-to-slf4j</td>
<td>2.10.0</td>
</tr>
<tr>
<td>org.slf4j</td>
<td>jul-to-slf4j</td>
<td>1.7.25</td>
</tr>
</tbody>
</table>
<p>上面的列表中可知log的最終打印是使用logback實現的。项目中优先选用 <strong>spring-boot-starter-logging</strong></p>
<h2 id="logback配置"><a href="#logback配置" class="headerlink" title="logback配置"></a>logback配置</h2><p>先看一个典型的配置文件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">debug</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"spring-boot-logging"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">contextName</span>&gt;</span>$&#123;name&#125;<span class="tag">&lt;/<span class="name">contextName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"console"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.ConsoleAppender"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;36&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"rollingFile"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>logs/infisa.$&#123;name&#125;.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>logs/$&#123;name&#125;.%d&#123;yyyy-MM-dd&#125;.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;36&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- project default level --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"cn.lee.jason"</span> <span class="attr">level</span>=<span class="string">"info"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 定义根日志级别 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">"info"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"rollingFile"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"console"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="configuration"><a href="#configuration" class="headerlink" title="configuration"></a>configuration</h3><p>configuration是logback.xml的根节点，所有的配置项目都要位于configuration元素下面，可配置的属性有：</p>
<table>
<thead>
<tr>
<th>属性名称</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>scan</td>
<td>true</td>
<td>当此属性设置为true时，配置文件如果发生改变，将会被重新加载</td>
</tr>
<tr>
<td>scanPeriod</td>
<td>1min</td>
<td>设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。</td>
</tr>
<tr>
<td>debug</td>
<td>true</td>
<td>当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。</td>
</tr>
</tbody>
</table>
<h4 id="contextName"><a href="#contextName" class="headerlink" title="contextName"></a>contextName</h4><p>每个logger都关联到logger上下文，默认上下文名称为“default”。但可以使用<contextname>设置成其他名字，用于区分不同应用程序的记录。一旦设置，不能修改。</contextname></p>
<h4 id="property"><a href="#property" class="headerlink" title="property"></a>property</h4><p>用来定义变量值的标签，<property> 有两个属性，name和value；其中name的值是变量的名称，value的值时变量定义的值。通过<property>定义的值会被插入到logger上下文中。定义变量后，可以使“${}”来使用变量。<br>例如使用<property>定义上下文名称，然后在<contentname>设置logger上下文时使用。</contentname></property></property></property></p>
<h4 id="appender"><a href="#appender" class="headerlink" title="appender"></a>appender</h4><p>负责写日志的组件，它有两个必要属性name和class。name指定appender名称，class指定appender的全限定名.<br><img src="/2018/04/18/spring-boot-项目添加logback-2018-4-18/appenderClassDiagram.jpg" title="appender类图"></p>
<h5 id="ConsoleAppender"><a href="#ConsoleAppender" class="headerlink" title="ConsoleAppender"></a>ConsoleAppender</h5><p>日志输出到控制台，有以下子节点：</p>
<p><encoder>：对日志进行格式化。</encoder></p>
<p><target>：字符串System.out(默认)或者System.err（区别不多说了）</target></p>
<h5 id="FileAppender"><a href="#FileAppender" class="headerlink" title="FileAppender"></a>FileAppender</h5><p> 把日志添加到文件，有以下子节点：<br>　　　　　　<file>：被写入的文件名，可以是相对目录，也可以是绝对目录，如果上级目录不存在会自动创建，没有默认值。<br>　　　　　　<append>：如果是 true，日志被追加到文件结尾，如果是 false，清空现存文件，默认是true。<br>　　　　　　<encoder>：对记录事件进行格式化。（具体参数稍后讲解 ）<br>　　　　　　<prudent>：如果是 true，日志会被安全的写入文件，即使其他的FileAppender也在向此文件做写入操作，效率低，默认是 false。</prudent></encoder></append></file></p>
<h5 id="RollingFileAppender"><a href="#RollingFileAppender" class="headerlink" title="RollingFileAppender"></a>RollingFileAppender</h5><p>滚动记录文件，先将日志记录到指定文件，当符合某个条件时，将日志记录到其他文件。有以下子节点：<br>　　　　　　<file>：被写入的文件名，可以是相对目录，也可以是绝对目录，如果上级目录不存在会自动创建，没有默认值。<br>　　　　　　<append>：如果是 true，日志被追加到文件结尾，如果是 false，清空现存文件，默认是true。<br>　　　　　　<rollingpolicy>:当发生滚动时，决定RollingFileAppender的行为，涉及文件移动和重命名。属性class定义具体的滚动策略类<br>　　　　　　class=”ch.qos.logback.core.rolling.TimeBasedRollingPolicy”： 最常用的滚动策略，它根据时间来制定滚动策略，既负责滚动也负责出发滚动。有以下子节点：<br>　　　　　　　　<filenamepattern>：必要节点，包含文件名及“%d”转换符，“%d”可以包含一个java.text.SimpleDateFormat指定的时间格式，如：%d{yyyy-MM}。<br>如果直接使用 %d，默认格式是 yyyy-MM-dd。RollingFileAppender的file字节点可有可无，通过设置file，可以为活动文件和归档文件指定不同位置，当前日志总是记录到file指定的文件（活动文件），活动文件的名字不会改变；<br>如果没设置file，活动文件的名字会根据fileNamePattern 的值，每隔一段时间改变一次。“/”或者“\”会被当做目录分隔符。<br>　　　　　　　　<maxhistory>:<br>可选节点，控制保留的归档文件的最大数量，超出数量就删除旧文件。假设设置每个月滚动，且<maxhistory>是6，则只保存最近6个月的文件，删除之前的旧文件。注意，删除旧文件是，那些为了归档而创建的目录也会被删除。</maxhistory></maxhistory></filenamepattern></rollingpolicy></append></file></p>
<p>　　　　　　class=”ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy”： 查看当前活动文件的大小，如果超过指定大小会告知RollingFileAppender 触发当前活动文件滚动。只有一个节点:<br>　　　　　　　　<maxfilesize>:这是活动文件的大小，默认值是10MB。<br>　　　　　　　　<prudent>：当为true时，不支持FixedWindowRollingPolicy。支持TimeBasedRollingPolicy，但是有两个限制，1不支持也不允许文件压缩，2不能设置file属性，必须留空。    </prudent></maxfilesize></p>
<p>　　　　　　<triggeringpolicy>: 告知 RollingFileAppender 合适激活滚动。<br>　　　　　　class=”ch.qos.logback.core.rolling.FixedWindowRollingPolicy” 根据固定窗口算法重命名文件的滚动策略。有以下子节点：<br>　　　　　　　　<minindex>:窗口索引最小值<br>　　　　　　　　<maxindex>:窗口索引最大值，当用户指定的窗口过大时，会自动将窗口设置为12。<br>　　　　　　　　<filenamepattern>:必须包含“%i”例如，假设最小值和最大值分别为1和2，命名模式为 mylog%i.log,会产生归档文件mylog1.log和mylog2.log。还可以指定文件压缩选项，例如，mylog%i.log.gz 或者 没有log%i.log.zip</filenamepattern></maxindex></minindex></triggeringpolicy></p>
<h4 id="logger"><a href="#logger" class="headerlink" title="logger"></a>logger</h4><p>用来设置某一个包或具体的某一个类的日志打印级别、以及指定<appender>。<loger>仅有一个name属性，一个可选的level和一个可选的addtivity属性。<br>可以包含零个或多个<appender-ref>元素，标识这个appender将会添加到这个loger<br>　　　　name: 用来指定受此loger约束的某一个包或者具体的某一个类。<br>　　　　level: 用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL和OFF，还有一个特俗值INHERITED或者同义词NULL，代表强制执行上级的级别。 如果未设置此属性，那么当前loger将会继承上级的级别。<br>addtivity: 是否向上级loger传递打印信息。默认是true。同<loger>一样，可以包含零个或多个<appender-ref>元素，标识这个appender将会添加到这个loger。</appender-ref></loger></appender-ref></loger></appender></p>
<h4 id="root"><a href="#root" class="headerlink" title="root"></a>root</h4><p>它也是<loger>元素，但是它是根loger,是所有<loger>的上级。只有一个level属性，因为name已经被命名为”root”,且已经是最上级了。<br>　　　　level: 用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL和OFF，不能设置为INHERITED或者同义词NULL。 默认是DEBUG。    </loger></loger></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/1491256964.jpg"
               alt="Jason Lee" />
          <p class="site-author-name" itemprop="name">Jason Lee</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">65</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">42</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">97</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/jasonlee529" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.douban.com/people/68825986/" target="_blank" title="豆瓣">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  豆瓣
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cnblogs.com/jason0529/" target="_blank" title="博客园">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  博客园
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
        <a data-type="2" biz-keyword="威士忌" data-tmpl="720x220" data-tmplid="209" data-rd="2" data-style="2" data-border="1" href="#">威士忌</a>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-star"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason Lee</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js"></script>
  


  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("9xKonnO15v0AJMC7I1AA3uGR-gzGzoHsz", "tkE85yvpAJGajCnNt86tj3vw");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


  

  </div>
<script type="text/javascript">
    (function(win,doc){
        var s = doc.createElement("script"), h = doc.getElementsByTagName("head")[0];
        if (!win.alimamatk_show) {
            s.charset = "gbk";
            s.async = true;
            s.src = "https://alimama.alicdn.com/tkapi.js";
            h.insertBefore(s, h.firstChild);
        };
        var o = {
            pid: "mm_40017531_440150214_108550750301",/*推广单元ID，用于区分不同的推广渠道*/
            appkey: "",/*通过TOP平台申请的appkey，设置后引导成交会关联appkey*/
            unid: "",/*自定义统计字段*/
            type: "click" /* click 组件的入口标志 （使用click组件必设）*/
        };
        win.alimamatk_onload = win.alimamatk_onload || [];
        win.alimamatk_onload.push(o);
    })(window,document);
</script>


</body>
</html>
