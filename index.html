<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Java,Linux,Mysql,Devs" />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="Jason Lee Essay">
<meta property="og:url" content="https://blog.xiaokele.site/index.html">
<meta property="og:site_name" content="Jason Lee Essay">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jason Lee Essay">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.xiaokele.site/"/>



<meta name="google-site-verification" content="DCecPF2mdIv3j__CgHKZ7KkdHn9F-6f4Grk8xYgVklE" />
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<link rel="alternate" hreflang="zh-Hans" href="https://jasonlee529.github.io" />

<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
{'GTM-P2JZHDB':true});</script>


  <title> Jason Lee Essay </title>
  <!-- Google AdSense start -->
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-1336715083812391",
    enable_page_level_ads: true
  });
</script>
<meta name="baidu_union_verify" content="35dd5097cbf7f546e4ec61c6cbd012db">
  <!-- Google AdSense end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-36831740-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?69f02f078fd202b54793c69f3596a63f 69f02f078fd202b54793c69f3596a63f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  
  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>
    <a href="https://github.com/jasonlee529"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jason Lee Essay</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Only dead fish go with the flow!</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>


 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2020/12/25/Mysql的联合索引-最左匹配的隐藏规则/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/12/25/Mysql的联合索引-最左匹配的隐藏规则/" itemprop="url">
                  Mysql的联合索引-最左匹配的隐藏规则
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-12-25T15:05:19+08:00">
                2020-12-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mysql/" itemprop="url" rel="index">
                    <span itemprop="name">Mysql</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2020/12/25/Mysql的联合索引-最左匹配的隐藏规则/" class="leancloud_visitors" data-flag-title="Mysql的联合索引-最左匹配的隐藏规则">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="联合最左匹配原则"><a href="#联合最左匹配原则" class="headerlink" title="联合最左匹配原则"></a>联合最左匹配原则</h2><ol>
<li><p>最左前缀匹配原则，非常重要的原则，mysql会一直向右匹配直到遇到范围查询(&gt;、&lt;、between、like)就停止匹配，比如a = 1 and b = 2 and c &gt; 3 and d = 4 如果建立(a,b,c,d)顺序的索引，d是用不到索引的，如果建立(a,b,d,c)的索引则都可以用到，a,b,d的顺序可以任意调整。</p>
</li>
<li><p>=和in可以乱序，比如a = 1 and b = 2 and c = 3 建立(a,b,c)索引可以任意顺序，mysql的查询优化器会帮你优化成索引可以识别的形式。</p>
</li>
<li><p>尽量选择区分度高的列作为索引，区分度的公式是count(distinct col)/count(*)，表示字段不重复的比例，比例越大我们扫描的记录数越少，唯一键的区分度是1，而一些状态、性别字段可能在大数据面前区分度就是0，那可能有人会问，这个比例有什么经验值吗？使用场景不同，这个值也很难确定，一般需要join的字段我们都要求是0.1以上，即平均1条扫描10条记录。</p>
</li>
<li><p>索引列不能参与计算，保持列“干净”，比如from_unixtime(create_time) = ’2014-05-29’就不能使用到索引，原因很简单，b+树中存的都是数据表中的字段值，但进行检索时，需要把所有元素都应用函数才能比较，显然成本太大。所以语句应该写成create_time = unix_timestamp(’2014-05-29’)。</p>
</li>
<li><p>尽量的扩展索引，不要新建索引。比如表中已经有a的索引，现在要加(a,b)的索引，那么只需要修改原来的索引即可。</p>
</li>
</ol>
<ol start="6">
<li>匹配某列的前缀索引，此时可以用到索引，但是如果通配符不是只出现在末尾，<br>则无法使用索引。</li>
</ol>
<h1 id="一组和原则相悖的实验"><a href="#一组和原则相悖的实验" class="headerlink" title="一组和原则相悖的实验"></a>一组和原则相悖的实验</h1><p>创建一个表，字段：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`abc`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`a`</span> <span class="built_in">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`b`</span> <span class="built_in">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`c`</span> <span class="built_in">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`idx_abc`</span> (<span class="string">`a`</span>,<span class="string">`b`</span>,<span class="string">`c`</span>) <span class="keyword">USING</span> BTREE</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>  ;</span><br></pre></td></tr></table></figure></p>
<h2 id="正常的查询"><a href="#正常的查询" class="headerlink" title="正常的查询"></a>正常的查询</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> abc t <span class="keyword">where</span> t.a=<span class="string">'a'</span> <span class="keyword">and</span> t.b=<span class="string">'b'</span> <span class="keyword">and</span> t.c=<span class="string">'c'</span>; // 三列索引</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> abc t <span class="keyword">where</span> t.a=<span class="string">'a'</span>  <span class="keyword">and</span> t.b=<span class="string">'b'</span>; // 2列</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> abc t <span class="keyword">where</span> t.a=<span class="string">'a'</span>  <span class="keyword">and</span> t.c=<span class="string">'c'</span>;//1列</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> abc t <span class="keyword">where</span> t.a=<span class="string">'a'</span>; //1列</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> abc t <span class="keyword">where</span> t.b=<span class="string">'b'</span>; // 0列</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> abc t <span class="keyword">where</span> t.c=<span class="string">'c'</span>; // 0列</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> abc t <span class="keyword">where</span> t.a=<span class="string">'a'</span>  <span class="keyword">and</span> t.c=<span class="string">'c'</span><span class="keyword">and</span> t.b&gt;<span class="string">'b'</span>; // 2列</span><br></pre></td></tr></table></figure>
<p>以上查询均可按照正常的最左索引进行。</p>
<h2 id="不符合原则的查询"><a href="#不符合原则的查询" class="headerlink" title="不符合原则的查询"></a>不符合原则的查询</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> abc t <span class="keyword">where</span>  t.b=<span class="string">'b'</span> <span class="keyword">and</span> t.c=<span class="string">'c'</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>id</th>
<th>select_type</th>
<th>table</th>
<th>type</th>
<th>possible_keys</th>
<th>key</th>
<th>key_len</th>
<th>ref</th>
<th>rows</th>
<th>Extra</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>SIMPLE</td>
<td>t</td>
<td>index</td>
<td></td>
<td>idx_abc</td>
<td>201</td>
<td></td>
<td>476</td>
<td>Using where; Using index</td>
</tr>
</tbody>
</table>
<p>结论很奇怪：按最左原则，b和c的查询，由于没有用到a列，所以不应该命中索引。</p>
<h2 id="神奇的地方"><a href="#神奇的地方" class="headerlink" title="神奇的地方"></a>神奇的地方</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`test`</span>.<span class="string">`abc`</span> </span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="string">`d`</span> <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="literal">NULL</span> <span class="keyword">AFTER</span> <span class="string">`c`</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> abc t <span class="keyword">where</span>  t.b=<span class="string">'b'</span> <span class="keyword">and</span> t.c=<span class="string">'c'</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>id</th>
<th>select_type</th>
<th>table</th>
<th>type</th>
<th>possible_keys</th>
<th>key</th>
<th>key_len</th>
<th>ref</th>
<th>rows</th>
<th>Extra</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>SIMPLE</td>
<td>t</td>
<td>ALL</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>476</td>
<td>Using where</td>
</tr>
</tbody>
</table>
<p>这轮索引没有命中，就因为多了一个字段吗？</p>
<h2 id="猜想"><a href="#猜想" class="headerlink" title="猜想"></a>猜想</h2><ol>
<li>当表中所有字段均在索引范围内，无论如何查询，都会试图用索引去提速。</li>
<li>B+Tree在构建的时候，对全部字段有特殊处理。</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2020/11/24/整数排序中的坑/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/11/24/整数排序中的坑/" itemprop="url">
                  整数排序中的坑
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-24T10:28:37+08:00">
                2020-11-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2020/11/24/整数排序中的坑/" class="leancloud_visitors" data-flag-title="整数排序中的坑">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Java中对集合或者数组排序一般有两个方法，类实现Comparable 接口或者 排序时使用定制化接口 Comparator。<br>以TreeSet为例，日常写法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> Set&lt;Integer&gt; sets = <span class="keyword">new</span> TreeSet&lt;&gt;(<span class="keyword">new</span> Comparator&lt;Integer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Integer o1, Integer o2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> o2 == o1 ? <span class="number">0</span> : o2 &gt; o1 ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">sets.add(<span class="number">1</span>);</span><br><span class="line">sets.add(-<span class="number">1</span>);</span><br><span class="line">sets.add(<span class="number">100</span>);</span><br><span class="line">System.out.println(Arrays.toString(sets.toArray(<span class="keyword">new</span> Integer[]&#123;&#125;)));</span><br><span class="line"><span class="comment">//[100, 1, -1]</span></span><br></pre></td></tr></table></figure></p>
<p>关于上面的写法，还有一种变种，就是改成o2-o1,似乎没有问题，看源码，使用Comparator的时候，是按照正负进行判断的<br><img src="/2020/11/24/整数排序中的坑/TreeMap-1.png" title="TreeMap源码"></p>
<h2 id="坑来了"><a href="#坑来了" class="headerlink" title="坑来了"></a>坑来了</h2><p>看例子<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;Integer&gt; sets = <span class="keyword">new</span> TreeSet&lt;&gt;(<span class="keyword">new</span> Comparator&lt;Integer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Integer o1, Integer o2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> o2-o1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">sets.add(<span class="number">1</span>);</span><br><span class="line">sets.add(-<span class="number">1</span>);</span><br><span class="line">sets.add(Integer.MIN_VALUE);</span><br><span class="line">System.out.println(Arrays.toString(sets.toArray(<span class="keyword">new</span> Integer[]&#123;&#125;)));</span><br><span class="line">[-<span class="number">2147483648</span>, <span class="number">1</span>, -<span class="number">1</span>]</span><br></pre></td></tr></table></figure></p>
<p>是不是不是预想的结果了，-2147483648成了最大值。</p>
<h2 id="原因："><a href="#原因：" class="headerlink" title="原因："></a>原因：</h2><p>很简单，做个测试 -2147483648 -1 = ？ 答案是 2147483648。<br>数字在边界处会溢出，比如 2147483648+1=-2147483648</p>
<h2 id="最佳实践："><a href="#最佳实践：" class="headerlink" title="最佳实践："></a>最佳实践：</h2><p>使用Comparator接口工作时，一定使用比较将结果控制在-1 ,0 1 三个值，保证结果稳定，如果使用数字加减排序，有可能因为有数字溢出导致结果异常。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2020/11/06/VScode-markdown插件收集/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/11/06/VScode-markdown插件收集/" itemprop="url">
                  VScode markdown插件收集
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-06T08:45:57+08:00">
                2020-11-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tools/" itemprop="url" rel="index">
                    <span itemprop="name">tools</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tools/markdown/" itemprop="url" rel="index">
                    <span itemprop="name">markdown</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2020/11/06/VScode-markdown插件收集/" class="leancloud_visitors" data-flag-title="VScode markdown插件收集">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-Markdown-all-in-one链接"><a href="#1-Markdown-all-in-one链接" class="headerlink" title="1. Markdown all in one链接"></a>1. Markdown all in one<a href="https://marketplace.visualstudio.com/items?itemName=yzhang.markdown-all-in-one" target="_blank" rel="noopener">链接</a></h1><p>全功能集，下载人数最多的一款，主要用到的格式化功能。</p>
<h1 id="2-Markdown-Preview-Enhanced链接"><a href="#2-Markdown-Preview-Enhanced链接" class="headerlink" title="2. Markdown Preview Enhanced链接"></a>2. Markdown Preview Enhanced<a href="https://marketplace.visualstudio.com/items?itemName=shd101wyy.markdown-preview-enhanced" target="_blank" rel="noopener">链接</a></h1><ul>
<li>自动编辑器及预览滑动同步</li>
<li>导入外部文件</li>
<li>Code Chunk</li>
<li>Pandoc</li>
<li>Prince</li>
<li>电子书</li>
<li>幻灯片</li>
<li>可扩展性</li>
<li>LaTeX 数学</li>
<li>导出 PDF, PNG, 以及 JPEG 凭借 Puppeteer</li>
<li>导出漂亮的 HTML（移动端支持）</li>
<li>编译到 GitHub Flavored Markdown</li>
<li>自定义预览 CSS</li>
<li>TOC 生成</li>
<li>流程图 / 时序图 以及各种其他种类的图形</li>
<li>嵌入 LaTeX, 渲染 TikZ, Chemfig 等图形</li>
<li>Task List (Github Flavored)</li>
<li>图片助手</li>
<li>脚注</li>
<li>Front Matter<h1 id="3-Markdown-Shortcuts链接"><a href="#3-Markdown-Shortcuts链接" class="headerlink" title="3. Markdown Shortcuts链接"></a>3. Markdown Shortcuts<a href="https://marketplace.visualstudio.com/items?itemName=mdickin.markdown-shortcuts" target="_blank" rel="noopener">链接</a></h1>快捷键合集，支持右键完成各种格式调整操作：加粗、斜体、表格等等<br>| Name                            | Description                                      | Default key binding |<br>| ——————————- | ———————————————— | ——————- |<br>| md-shortcut.showCommandPalette  | Display all commands                             | ctrl+M ctrl+M       |<br>| md-shortcut.toggleBold          | Make **bold**                                | ctrl+B              |<br>| md-shortcut.toggleItalic        | Make _italic_                                  | ctrl+I              |<br>| md-shortcut.toggleStrikethrough | Make ~~strikethrough~~                       |                     |<br>| md-shortcut.toggleLink          | Make [a hyperlink](<a href="http://www.example.org" target="_blank" rel="noopener">www.example.org</a>)             | ctrl+L              |<br>| md-shortcut.toggleImage         | Make an image ![](image_url.png)                | ctrl+shift+L        |<br>| md-shortcut.toggleCodeBlock     | Make ```a code block```                    | ctrl+M ctrl+C       |<br>| md-shortcut.toggleInlineCode    | Make `inline code`                             | ctrl+M ctrl+I       |<br>| md-shortcut.toggleBullets       | Make * bullet point                              | ctrl+M ctrl+B       |<br>| md-shortcut.toggleNumbers       | Make 1. numbered list                            | ctrl+M ctrl+1       |<br>| md-shortcut.toggleCheckboxes    | Make - [ ] check list (Github flavored markdown) | ctrl+M ctrl+X       |<br>| md-shortcut.toggleTitleH1       | Toggle # H1 title                                |                     |<br>| md-shortcut.toggleTitleH2       | Toggle ## H2 title                               |                     |<br>| md-shortcut.toggleTitleH3       | Toggle ### H3 title                              |                     |<br>| md-shortcut.toggleTitleH4       | Toggle #### H4 title                             |                     |<br>| md-shortcut.toggleTitleH5       | Toggle ##### H5 title                            |                     |<br>| md-shortcut.toggleTitleH6       | Toggle ###### H6 title                           |                     |<br>| md-shortcut.addTable            | Add Tabular values                               |                     |<br>| md-shortcut.addTableWithHeader  | Add Tabular values with header                   |                     |<h1 id="4-markdown-toc链接"><a href="#4-markdown-toc链接" class="headerlink" title="4. markdown-toc链接"></a>4. markdown-toc<a href="https://marketplace.visualstudio.com/items?itemName=AlanWalk.markdown-toc" target="_blank" rel="noopener">链接</a></h1>非常好用的目录生成工具，</li>
<li>Insert header number sections. 插入目录段落序号</li>
<li>Auto active plugin on markdown。 </li>
<li>Insert anchor for header <code>&lt;a id=&quot;markdown-header&quot; name=&quot;header&quot;&gt;&lt;/a&gt;</code> 插入锚到文件头</li>
<li>Linking via anchor tags # A 1 → #a-1  自动重拍段落编号</li>
<li>Depth control[1-6] with depthFrom:1 and depthTo:6 段落编号支持6级</li>
<li>Enable or disable links with withLinks:true </li>
<li>Refresh list on save with updateOnSave:true</li>
<li>Use ordered list (1. …, 2. …) with orderedList:true</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2020/11/05/DDD领域驱动设计-1-基础概念/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/11/05/DDD领域驱动设计-1-基础概念/" itemprop="url">
                  DDD领域驱动设计#1-基础概念
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-11-05T17:33:58+08:00">
                2020-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/设计/" itemprop="url" rel="index">
                    <span itemprop="name">设计</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/设计/DDD/" itemprop="url" rel="index">
                    <span itemprop="name">DDD</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2020/11/05/DDD领域驱动设计-1-基础概念/" class="leancloud_visitors" data-flag-title="DDD领域驱动设计#1-基础概念">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-领域-Domain"><a href="#1-领域-Domain" class="headerlink" title="1. 领域-Domain"></a>1. 领域-Domain</h1><p>领域是一个组织所做的事情以及其中所包含的一切。是基于业务来确定的，一个项目或一个产品面对的是什么行业、什么样的组织即项目领域。<br>领域是具有相对性的概念，一个项目的领域可能是另一个项目的通用子域，因为业务对象是不同的。<br>在一个项目中，领域需要被划分为多个子域，子域有核心子域，关联子域，通用子域。</p>
<h2 id="1-1-如何定义领域"><a href="#1-1-如何定义领域" class="headerlink" title="1.1. 如何定义领域"></a>1.1. 如何定义领域</h2><ol>
<li>战略设计</li>
<li>战术设计<h1 id="2-子域"><a href="#2-子域" class="headerlink" title="2. 子域"></a>2. 子域</h1>子域即对领域中某一类的业务的问题集合，是具体的问题实现。<h1 id="3-限界上下文"><a href="#3-限界上下文" class="headerlink" title="3. 限界上下文"></a>3. 限界上下文</h1>限界上下文（Bounded Context）定义了每个模型的应用范围，在每个Bounded Context中确保领域模型的一致性。不同的限界上下文中，领域模型可以不用保证一致性。通常我们根据团队的组织、软件系统的每个部分的用法及物理表现（如组件划分，数据库模式）来设置模型的边界。</li>
</ol>
<h1 id="4-架构"><a href="#4-架构" class="headerlink" title="4. 架构"></a>4. 架构</h1><h1 id="5-实体"><a href="#5-实体" class="headerlink" title="5. 实体"></a>5. 实体</h1><h1 id="6-值对象"><a href="#6-值对象" class="headerlink" title="6. 值对象"></a>6. 值对象</h1><h1 id="7-聚合根"><a href="#7-聚合根" class="headerlink" title="7. 聚合根"></a>7. 聚合根</h1>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2019/09/05/spring-boot引入swagger-ui/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/09/05/spring-boot引入swagger-ui/" itemprop="url">
                  spring-boot引入swagger-ui
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-05T17:01:54+08:00">
                2019-09-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/swagger/" itemprop="url" rel="index">
                    <span itemprop="name">swagger</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/09/05/spring-boot引入swagger-ui/" class="leancloud_visitors" data-flag-title="spring-boot引入swagger-ui">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Swagger-ui-Spring-boot集成方法"><a href="#Swagger-ui-Spring-boot集成方法" class="headerlink" title="Swagger-ui Spring-boot集成方法"></a>Swagger-ui Spring-boot集成方法</h1><blockquote>
<p>现在做的Java项目基本上都是前后端分离的,后端只提供api接口即可,和前端交互的时候都是用json,程序员都讨厌写文档,但是不写接口文档肯定要被前端开发喷死.</p>
</blockquote>
<h3 id="Swagger-ui介绍"><a href="#Swagger-ui介绍" class="headerlink" title="Swagger-ui介绍"></a>Swagger-ui介绍</h3><p>Swagger是个前后端协作的利器，解析代码里的注解生成JSON文件，通过Swagger UI生成网页版的接口文档，可以在上面做简单的接口调试 也可以自动生成文档给前端人员调试</p>
<h3 id="页面："><a href="#页面：" class="headerlink" title="页面："></a>页面：</h3><img src="/2019/09/05/spring-boot引入swagger-ui/swagger-ui-web.png" title="swagger-ui">
<h3 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h3><h4 id="引入依赖："><a href="#引入依赖：" class="headerlink" title="引入依赖："></a>引入依赖：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;springfox.swagger2.version&gt;2.8.0&lt;/pringfox.swagger2.version&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;$&#123;springfox.swagger2.version&#125;&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;$&#123;springfox.swagger.ui.version&#125;&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger</span>2</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">api</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">//包路径</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">"cn.infisa.swagger"</span>)) </span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">                .title(<span class="string">"测试系统"</span>) </span><br><span class="line">                .description(<span class="string">"测试系统"</span>)</span><br><span class="line">                .version(<span class="string">"1.0"</span>)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="标记RestController"><a href="#标记RestController" class="headerlink" title="标记RestController"></a>标记RestController</h4><p>主要用到两个注解 <strong>@API</strong> 和 <strong>@ApiOperation</strong><br>@API<br>用于注解类<br>@ApiOperation<br>用于注解方法</p>
<p>将上述注解加到需要生成接口文档的RestController和RequestMapping上，之后启动服务即可生成接口文档。<br>输入：<a href="http://localhost:8080/swagger-ui.html即可访问API列表。" target="_blank" rel="noopener">http://localhost:8080/swagger-ui.html即可访问API列表。</a></p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><ol>
<li><p>get接口</p>
<img src="/2019/09/05/spring-boot引入swagger-ui/get.png" title="swagger-ui">
</li>
<li><p>shiro get接口</p>
<img src="/2019/09/05/spring-boot引入swagger-ui/shiro-get.png" title="swagger-ui">
</li>
</ol>
<h3 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h3><h4 id="1-shiro的集成"><a href="#1-shiro的集成" class="headerlink" title="1. shiro的集成"></a>1. shiro的集成</h4><ol>
<li>在shiro中放行swagger-ui的页面 </li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开放swagger</span></span><br><span class="line">chains.put(<span class="string">"/swagger-resources/**"</span>, <span class="string">"anon"</span>);</span><br><span class="line">chains.put(<span class="string">"/webjars/**"</span>, <span class="string">"anon"</span>);</span><br><span class="line">chains.put(<span class="string">"/v2/**"</span>, <span class="string">"anon"</span>);</span><br><span class="line">chains.put(<span class="string">"/swagger-ui.html/**"</span>, <span class="string">"anon"</span>);</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>请求中加入ctoken参数，方法上增加注解</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiImplicitParams</span>(&#123;</span><br><span class="line">        <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"ctoken"</span>, required = <span class="keyword">true</span>, value = <span class="string">"a"</span>, paramType = <span class="string">"header"</span>),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2019/08/30/Kafka-Java-ProducerAPI的例子/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/08/30/Kafka-Java-ProducerAPI的例子/" itemprop="url">
                  Kafka-Java ProducerAPI的例子
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-30T15:11:30+08:00">
                2019-08-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/Kafka/" itemprop="url" rel="index">
                    <span itemprop="name">Kafka</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/08/30/Kafka-Java-ProducerAPI的例子/" class="leancloud_visitors" data-flag-title="Kafka-Java ProducerAPI的例子">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h2><p>启动一个Kafka集群实例，启动方式参考<a href="http://kafka.apache.org/quickstart" target="_blank" rel="noopener">官网教程</a>。地址为：192.168.1.173:9092</p>
<h2 id="Project"><a href="#Project" class="headerlink" title="Project"></a>Project</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kafka客户端依赖，利用Java-ProducerAPI生成数据发送给kafka。</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.3.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Properties props = <span class="keyword">new</span> Properties();</span><br><span class="line">props.put(<span class="string">"bootstrap.servers"</span>, <span class="string">"192.168.1.173:9092"</span>);</span><br><span class="line">props.put(<span class="string">"key.serializer"</span>, <span class="string">"org.apache.kafka.common.serialization.StringSerializer"</span>);</span><br><span class="line">props.put(<span class="string">"value.serializer"</span>, <span class="string">"org.apache.kafka.common.serialization.StringSerializer"</span>);</span><br><span class="line">KafkaProducer producer = <span class="keyword">new</span> KafkaProducer&lt;String, String&gt;(props);</span><br><span class="line">ProducerRecord record = <span class="keyword">new</span> ProducerRecord&lt;String, String&gt;(topic, <span class="keyword">null</span>, <span class="keyword">null</span>, JacksonUtils.nonDefaultMapper().toJson(student));</span><br></pre></td></tr></table></figure>
<p>上面这段类似与shell启动一个Producer<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-console-producer.sh --broker-list 192.168.1.173:9092 --topic student</span><br></pre></td></tr></table></figure></p>
<p>不过shell启动的方式只能通过控制台输入信息，Java部分通过代码生成数据发送。</p>
<h2 id="运行："><a href="#运行：" class="headerlink" title="运行："></a>运行：</h2><p>发送端：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">发送数据: &#123;"id":77064,"name":"bhdX","password":"xfZUDcVG","age":16&#125;</span><br><span class="line">发送数据: &#123;"id":77065,"name":"HgkO","password":"JkJXpgOp","age":57&#125;</span><br><span class="line">发送数据: &#123;"id":77066,"name":"fIMG","password":"VSivsZtI","age":26&#125;</span><br><span class="line">发送数据: &#123;"id":77067,"name":"nzFk","password":"jupUFQDN","age":42&#125;</span><br><span class="line">发送数据: &#123;"id":77068,"name":"czDo","password":"rhcvkLHO","age":52&#125;</span><br><span class="line">发送数据: &#123;"id":77069,"name":"UzEo","password":"VhBYLAph","age":22&#125;</span><br><span class="line">发送数据: &#123;"id":77070,"name":"Wult","password":"xhXxxwxg","age":22&#125;</span><br><span class="line">发送数据: &#123;"id":77071,"name":"yvAv","password":"eoYLmEqD","age":15&#125;</span><br><span class="line">发送数据: &#123;"id":77072,"name":"nqoF","password":"uvIDROzp","age":15&#125;</span><br><span class="line">发送数据: &#123;"id":77073,"name":"LrXX","password":"JdvTFdEj","age":93&#125;</span><br><span class="line">发送数据: &#123;"id":77074,"name":"HIZA","password":"xKKZBhbY","age":44&#125;</span><br><span class="line">发送数据: &#123;"id":77075,"name":"UuNe","password":"XELywaGT","age":82&#125;</span><br></pre></td></tr></table></figure></p>
<p>另外启动一个kafka-consumer，查看输出：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> bin/kafka-console-consumer.sh --bootstrap-server 192.168.1.173:9092 \</span><br><span class="line">    --topic student \ </span><br><span class="line">    --from-beginning </span><br><span class="line">&#123;"id":77064,"name":"bhdX","password":"xfZUDcVG","age":16&#125;</span><br><span class="line">&#123;"id":77065,"name":"HgkO","password":"JkJXpgOp","age":57&#125;</span><br><span class="line">&#123;"id":77066,"name":"fIMG","password":"VSivsZtI","age":26&#125;</span><br><span class="line">&#123;"id":77067,"name":"nzFk","password":"jupUFQDN","age":42&#125;</span><br><span class="line">&#123;"id":77068,"name":"czDo","password":"rhcvkLHO","age":52&#125;</span><br><span class="line">&#123;"id":77069,"name":"UzEo","password":"VhBYLAph","age":22&#125;</span><br><span class="line">&#123;"id":77070,"name":"Wult","password":"xhXxxwxg","age":22&#125;</span><br><span class="line">&#123;"id":77071,"name":"yvAv","password":"eoYLmEqD","age":15&#125;</span><br><span class="line">&#123;"id":77072,"name":"nqoF","password":"uvIDROzp","age":15&#125;</span><br><span class="line">&#123;"id":77073,"name":"LrXX","password":"JdvTFdEj","age":93&#125;</span><br><span class="line">&#123;"id":77074,"name":"HIZA","password":"xKKZBhbY","age":44&#125;</span><br><span class="line">&#123;"id":77075,"name":"UuNe","password":"XELywaGT","age":82&#125;</span><br></pre></td></tr></table></figure></p>
<p>代码地址：<a href="https://gitee.com/jasonlee0529/bigdata-all/tree/master/kafka/kafka-provider" target="_blank" rel="noopener">https://gitee.com/jasonlee0529/bigdata-all/tree/master/kafka/kafka-provider</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2019/08/20/Postgresql安装/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/08/20/Postgresql安装/" itemprop="url">
                  Postgresql安装
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-20T10:05:00+08:00">
                2019-08-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/postgresql/" itemprop="url" rel="index">
                    <span itemprop="name">postgresql</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/08/20/Postgresql安装/" class="leancloud_visitors" data-flag-title="Postgresql安装">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="yum安装"><a href="#yum安装" class="headerlink" title="yum安装"></a>yum安装</h4><p>过程在官方文档都有：<a href="https://www.postgresql.org/download/linux/redhat/" target="_blank" rel="noopener">https://www.postgresql.org/download/linux/redhat/</a><br><img src="/2019/08/20/Postgresql安装/installation.png" title="下载地址"></p>
<h4 id="安装完成后修改登录密码："><a href="#安装完成后修改登录密码：" class="headerlink" title="安装完成后修改登录密码："></a>安装完成后修改登录密码：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# su - postgres</span><br><span class="line">-bash-4.2$ psql -U postgres</span><br><span class="line">postgres=# alter user postgres with password '123456';</span><br><span class="line">ALTER ROLE</span><br><span class="line">postgres=#\q</span><br></pre></td></tr></table></figure>
<h4 id="开启远程访问"><a href="#开启远程访问" class="headerlink" title="开启远程访问"></a>开启远程访问</h4><p>修改配置文件<strong>/var/lib/pgsql/11/data/postgresql.conf</strong> 。将listen_addresses的值改为*。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>listen_addresses = 'localhost'     # what IP address(es) to listen on;</span><br><span class="line">                    # comma-separated list of addresses;</span><br><span class="line">                    # defaults to 'localhost'; use '*' for all</span><br><span class="line">                    # (change requires restart)</span><br><span class="line">listen_addresses='*'</span><br></pre></td></tr></table></figure></p>
<h4 id="信任远程连接"><a href="#信任远程连接" class="headerlink" title="信任远程连接"></a>信任远程连接</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vim /var/lib/pgsql/11/data/pg_hba.conf</span><br><span class="line"><span class="meta">#</span> IPv4 local connections:</span><br><span class="line">host    all             all             127.0.0.1/32            ident</span><br><span class="line"></span><br><span class="line">改为：</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> IPv4 local connections:</span><br><span class="line">host    all             all             127.0.0.1/32            ident</span><br><span class="line">host    all             all             192.168.1.1/24          trust</span><br></pre></td></tr></table></figure>
<h4 id="致命错误-没有用于主机-“xxx”-用户-“postgres”-数据库-“postgres”-SSL-关闭-的-pg-hba-conf-记录"><a href="#致命错误-没有用于主机-“xxx”-用户-“postgres”-数据库-“postgres”-SSL-关闭-的-pg-hba-conf-记录" class="headerlink" title="致命错误: 没有用于主机 “xxx”, 用户 “postgres”, 数据库 “postgres”, SSL 关闭 的 pg_hba.conf 记录"></a>致命错误: 没有用于主机 “xxx”, 用户 “postgres”, 数据库 “postgres”, SSL 关闭 的 pg_hba.conf 记录</h4><p>注意pa_hba.conf文件里面的主机地址(address)配置是否正确，链接地址与主机地址是否在同一子网中，注意子网掩码的配置。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2019/07/26/gulp-default-task/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/07/26/gulp-default-task/" itemprop="url">
                  gulp default task
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-26T14:49:00+08:00">
                2019-07-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/node/" itemprop="url" rel="index">
                    <span itemprop="name">node</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/node/gulp/" itemprop="url" rel="index">
                    <span itemprop="name">gulp</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/07/26/gulp-default-task/" class="leancloud_visitors" data-flag-title="gulp default task">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入包</span></span><br><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>),</span><br><span class="line">    merge = <span class="built_in">require</span>(<span class="string">'merge-stream'</span>),</span><br><span class="line">    preprocess = <span class="built_in">require</span>(<span class="string">'gulp-preprocess'</span>),</span><br><span class="line">    cssmin = <span class="built_in">require</span>(<span class="string">'gulp-clean-css'</span>), <span class="comment">// css压缩  </span></span><br><span class="line">    sass = <span class="built_in">require</span>(<span class="string">'gulp-sass'</span>),</span><br><span class="line">    sassImport = <span class="built_in">require</span>(<span class="string">'gulp-sass-import'</span>),</span><br><span class="line">    rename = <span class="built_in">require</span>(<span class="string">'gulp-rename'</span>), <span class="comment">// 重命名</span></span><br><span class="line">    del = <span class="built_in">require</span>(<span class="string">'del'</span>), <span class="comment">// 文件清理  </span></span><br><span class="line">    runSequence = <span class="built_in">require</span>(<span class="string">'run-sequence'</span>); <span class="comment">// 多任务 </span></span><br><span class="line">    </span><br><span class="line">gulp.task(<span class="string">'clean'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> del(<span class="string">"dist"</span>, cb);</span><br><span class="line">&#125;)</span><br><span class="line">gulp.task(<span class="string">'bower'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'bower_components/**'</span>)</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist/bower_components'</span>));</span><br><span class="line">&#125;)</span><br><span class="line">gulp.task(<span class="string">'css'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'**/**/*.css'</span>, <span class="string">'!bower_components/**'</span>, <span class="string">'!node_modules/**'</span>, <span class="string">'!src/plugin/**'</span>])</span><br><span class="line">        .pipe(cssmin(&#123;</span><br><span class="line">            advanced: <span class="literal">true</span>, <span class="comment">//类型：Boolean 默认：true [是否开启高级优化（合并选择器等）]</span></span><br><span class="line">            compatibility: <span class="string">''</span>, <span class="comment">//保留ie7及以下兼容写法 类型：String 默认：''or'*' [启用兼容模式； 'ie7'：IE7兼容模式，'ie8'：IE8兼容模式，'*'：IE9+兼容模式]</span></span><br><span class="line">            keepBreaks: <span class="literal">false</span>, <span class="comment">//类型：Boolean 默认：false [是否保留换行]</span></span><br><span class="line">            keepSpecialComments: <span class="string">'*'</span> <span class="comment">//保留所有特殊前缀 当你用autoprefixer生成的浏览器前缀，如果不加这个参数，有可能将会删除你的部分前缀</span></span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist/'</span>));</span><br><span class="line">&#125;)</span><br><span class="line">gulp.task(<span class="string">'sass'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'**/**/*.scss'</span>, <span class="string">'!bower_components/**'</span>, <span class="string">'!node_modules/**'</span>, <span class="string">'!src/plugin/**'</span>])</span><br><span class="line">        .pipe(sassImport(&#123;</span><br><span class="line">            filename: <span class="string">'_file'</span>,</span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(sass().on(<span class="string">'error'</span>, sass.logError))</span><br><span class="line">        .pipe(cssmin(&#123;</span><br><span class="line">            advanced: <span class="literal">true</span>, <span class="comment">//类型：Boolean 默认：true [是否开启高级优化（合并选择器等）]</span></span><br><span class="line">            compatibility: <span class="string">''</span>, <span class="comment">//保留ie7及以下兼容写法 类型：String 默认：''or'*' [启用兼容模式； 'ie7'：IE7兼容模式，'ie8'：IE8兼容模式，'*'：IE9+兼容模式]</span></span><br><span class="line">            keepBreaks: <span class="literal">false</span>, <span class="comment">//类型：Boolean 默认：false [是否保留换行]</span></span><br><span class="line">            keepSpecialComments: <span class="string">'*'</span> <span class="comment">//保留所有特殊前缀 当你用autoprefixer生成的浏览器前缀，如果不加这个参数，有可能将会删除你的部分前缀</span></span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist/'</span>));</span><br><span class="line">&#125;)</span><br><span class="line">gulp.task(<span class="string">'html'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'**/**/*.html'</span>, <span class="string">'!src/plugin'</span>])</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist/'</span>));</span><br><span class="line">&#125;)</span><br><span class="line">gulp.task(<span class="string">'image'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'**/**/*.png'</span>, <span class="string">'**/**/*.jpg'</span>, <span class="string">'!bower_components/**'</span>, <span class="string">'!node_modules/**'</span>, <span class="string">'!src/plugin/**'</span>])</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist/'</span>))</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> folders=[];</span><br><span class="line">gulp.task(<span class="string">'js'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tasks = folders.map(<span class="function"><span class="keyword">function</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> gulp.src(element + <span class="string">'/**/*.js'</span>)</span><br><span class="line">            .pipe(concat(<span class="string">'all.js'</span>))</span><br><span class="line">            .pipe(gulp.dest(<span class="string">"dist/"</span> + element))</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> merge(tasks);</span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'env'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> env1 = process.env.NODE_ENV || <span class="string">'dev'</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(process.argv);</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'env/env.'</span> + env1 + <span class="string">'.js'</span>)</span><br><span class="line">        .pipe(concat(<span class="string">'env.js'</span>))</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist/env'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; series, parallel &#125; = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line">exports.default = series(<span class="string">'clean'</span>, parallel(<span class="string">'bower'</span>, <span class="string">'image'</span>, <span class="string">'css'</span>, <span class="string">'sass'</span>, <span class="string">'html'</span>, <span class="string">'env'</span>, <span class="string">'js'</span>));</span><br><span class="line"><span class="keyword">var</span> logger = <span class="function"><span class="keyword">function</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(msg);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2019/07/18/SpringCloud配置碎碎念/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/07/18/SpringCloud配置碎碎念/" itemprop="url">
                  SpringCloud配置碎碎念
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-18T16:36:00+08:00">
                2019-07-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/SpirngCloud/" itemprop="url" rel="index">
                    <span itemprop="name">SpirngCloud</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/07/18/SpringCloud配置碎碎念/" class="leancloud_visitors" data-flag-title="SpringCloud配置碎碎念">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>SpringCloud配置信息部分解释如下：</p>
<h4 id="eureka-instance-prefer-ip-address"><a href="#eureka-instance-prefer-ip-address" class="headerlink" title="eureka.instance.prefer-ip-address"></a>eureka.instance.prefer-ip-address</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Flag to say that, when guessing a hostname, the IP address of the server should be</span></span><br><span class="line"><span class="comment">* used in prference to the hostname reported by the OS.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> preferIpAddress = <span class="keyword">false</span>;</span><br></pre></td></tr></table></figure>
<p>这段的意思是是否需要将serverName 转换为IP地址注册到eureka-server中。<br>两个例子：<br>1115 端口<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">1115</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line"><span class="attr">  instance:</span></span><br><span class="line"><span class="attr">    prefer-ip-address:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></p>
<p>1116端口<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">1116</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line"><span class="attr">  instance:</span></span><br><span class="line"><span class="attr">    prefer-ip-address:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure></p>
<p>结果：1115端口转换为了IP地址注册，1116端口没有注册转换名称给服务器。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">&quot;URI：http://192.168.1.26:1115，service_id：CLIENT-CONSUMER&quot;,</span><br><span class="line">&quot;URI：http://peer1:1116，service_id：CLIENT-CONSUMER&quot;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.xiaokele.site/2019/05/09/命令行使用proxy全记录-2019-5-9/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jason Lee">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/1491256964.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Jason Lee Essay">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Jason Lee Essay" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/05/09/命令行使用proxy全记录-2019-5-9/" itemprop="url">
                  命令行使用proxy全记录
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-09T14:38:00+08:00">
                2019-05-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/05/09/命令行使用proxy全记录-2019-5-9/" class="leancloud_visitors" data-flag-title="命令行使用proxy全记录">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在各种的网络封锁下，访问google必须需要proxy代理才能访问到，而代理有时和各种的缓存有相似之处，本质上都是一个服务无法访问到或者响应慢，通过一个或多个中间服务器形成一个较快的链接。这里记录下各种代理的使用方式。</p>
<ol>
<li><a href="#git">git</a></li>
<li><a href="#docker">docker</a></li>
<li><a href="#npm">npm</a></li>
<li><a href="#apt">apt</a></li>
</ol>
<h3 id="git"><a href="#git" class="headerlink" title="git"></a>git</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global https.proxy socks5://localhost:1080</span><br></pre></td></tr></table></figure>
<p>验证：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@localhost: # git config --global --get-regexp http.*</span><br><span class="line">https.proxy socks5://127.0.0.1:1080</span><br></pre></td></tr></table></figure></p>
<h3 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h3><h3 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h3><h3 id="apt"><a href="#apt" class="headerlink" title="apt"></a>apt</h3>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/1491256964.jpg"
               alt="Jason Lee" />
          <p class="site-author-name" itemprop="name">Jason Lee</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">65</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">42</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">97</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/jasonlee529" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.douban.com/people/68825986/" target="_blank" title="豆瓣">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  豆瓣
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cnblogs.com/jason0529/" target="_blank" title="博客园">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  博客园
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
        <a data-type="2" biz-keyword="威士忌" data-tmpl="720x220" data-tmplid="209" data-rd="2" data-style="2" data-border="1" href="#">威士忌</a>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-star"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason Lee</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js"></script>
  


  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("9xKonnO15v0AJMC7I1AA3uGR-gzGzoHsz", "tkE85yvpAJGajCnNt86tj3vw");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


  

  </div>
<script type="text/javascript">
    (function(win,doc){
        var s = doc.createElement("script"), h = doc.getElementsByTagName("head")[0];
        if (!win.alimamatk_show) {
            s.charset = "gbk";
            s.async = true;
            s.src = "https://alimama.alicdn.com/tkapi.js";
            h.insertBefore(s, h.firstChild);
        };
        var o = {
            pid: "mm_40017531_440150214_108550750301",/*推广单元ID，用于区分不同的推广渠道*/
            appkey: "",/*通过TOP平台申请的appkey，设置后引导成交会关联appkey*/
            unid: "",/*自定义统计字段*/
            type: "click" /* click 组件的入口标志 （使用click组件必设）*/
        };
        win.alimamatk_onload = win.alimamatk_onload || [];
        win.alimamatk_onload.push(o);
    })(window,document);
</script>


</body>
</html>
